!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function t(e,n,t,r,a,u,l){try{var i=e[u](l),o=i.value}catch(c){return void t(c)}i.done?n(o):Promise.resolve(o).then(r,a)}function r(e){return function(){var n=this,r=arguments;return new Promise((function(a,u){var l=e.apply(n,r);function i(e){t(l,a,u,i,o,"next",e)}function o(e){t(l,a,u,i,o,"throw",e)}i(void 0)}))}}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}System.register(["./vendor-legacy.3e4a7622.js","./FileSaver.min-legacy.f9d7ce6a.js","./usePropVModel-legacy.6eba5997.js","./index-legacy.16e0f4f4.js","./uniqBy-legacy.93d96c2f.js","./_baseIteratee-legacy.795ef011.js"],(function(n){"use strict";var t,l,i,o,c,s,d,f,m,p,v,h,x,y,g,b,_,N,T,O,C,A,I,U,w,P,S,R,k,G,V,E,D,L,j;return{setters:[function(e){t=e.d,l=e._,i=e.$,o=e.a0,c=e.a1,s=e.a2,d=e.y,f=e.k,m=e.l,p=e.E,v=e.C,h=e.a3,x=e.F,y=e.G,g=e.t,b=e.x,_=e.X,N=e.a4,T=e.a,O=e.w,C=e.r,A=e.j,I=e.H,U=e.a5,w=e.a6,P=e.q,S=e.S,R=e.a7},function(e){k=e.s,G=e.F},function(e){V=e.u},function(e){E=e._,D=e.e,L=e.S},function(e){j=e.u},function(){}],execute:function(){var q=t({name:"RaceActionInput",props:{modelValue:{type:String,required:!0}},setup:function(e,n){var t=V(n,e,"modelValue");return{actionProxy:t,labelClass:function(e){return{"form-button inline-flex flex-center p-px h-8 flex-auto":!0,"bg-blue-400 text-white hover:bg-blue-300":t.value===e}},svgClass:"fill-current h-6 py-px"}},data:function(){return{mdiCancel:l,mdiShieldCheck:i,mdiThumbUp:o,mdiThumbDown:c,mdiThumbsUpDown:s}}}),B=["d"],W=["d"],F=["d"],M=["d"],J=["d"];var K=E(q,[["render",function(e,n,t,r,a,u){return d(),f(x,null,[m("label",{class:p(e.labelClass("ban"))},[(d(),f("svg",{class:p(e.svgClass),viewBox:"0 0 24 24"},[m("path",{d:e.mdiCancel},null,8,B)],2)),v(m("input",{"onUpdate:modelValue":n[0]||(n[0]=function(n){return e.actionProxy=n}),type:"radio",class:"hidden",value:"ban"},null,512),[[h,e.actionProxy]])],2),m("label",{class:p(e.labelClass("less"))},[(d(),f("svg",{class:p(e.svgClass),viewBox:"0 0 24 24"},[m("path",{d:e.mdiThumbDown},null,8,W)],2)),v(m("input",{"onUpdate:modelValue":n[1]||(n[1]=function(n){return e.actionProxy=n}),type:"radio",class:"hidden",value:"less"},null,512),[[h,e.actionProxy]])],2),m("label",{class:p(e.labelClass("none"))},[(d(),f("svg",{class:p(e.svgClass),viewBox:"0 0 24 24"},[m("path",{d:e.mdiThumbsUpDown},null,8,F)],2)),v(m("input",{"onUpdate:modelValue":n[2]||(n[2]=function(n){return e.actionProxy=n}),type:"radio",class:"hidden",value:"none"},null,512),[[h,e.actionProxy]])],2),m("label",{class:p(e.labelClass("more"))},[(d(),f("svg",{class:p(e.svgClass),viewBox:"0 0 24 24"},[m("path",{d:e.mdiThumbUp},null,8,M)],2)),v(m("input",{"onUpdate:modelValue":n[3]||(n[3]=function(n){return e.actionProxy=n}),type:"radio",class:"hidden",value:"more"},null,512),[[h,e.actionProxy]])],2),m("label",{class:p(e.labelClass("pick"))},[(d(),f("svg",{class:p(e.svgClass),viewBox:"0 0 24 24"},[m("path",{d:e.mdiShieldCheck},null,8,J)],2)),v(m("input",{"onUpdate:modelValue":n[4]||(n[4]=function(n){return e.actionProxy=n}),type:"radio",class:"hidden",value:"pick"},null,512),[[h,e.actionProxy]])],2)],64)}]]);function $(e){var n=Math.floor(e/24)+1,t=function(){switch(n){case 1:return"ジュニア級";case 2:return"クラシック級";case 3:return"シニア級";default:return"Year ".concat(n)}}(),r=e%2+1,a=1===r?"前半":"後半",u=(e-(r-1))/2%12+1,l="".concat(u," 月");return{year:n,yearText:t,month:u,monthText:l,half:r,halfText:a}}var H=t({name:"SingleModeTurnWidget",props:{value:{type:Number,required:!0}},setup:function(e){return{turn:y((function(){return $(e.value)}))}}});var X,Y,z=E(H,[["render",function(e,n,t,r,a,u){return g(e.turn.yearText)+" "+g(e.turn.monthText)+" "+g(e.turn.halfText)}]]);(Y=X||(X={}))[Y.DEBUT=900]="DEBUT",Y[Y.NOT_WINNING=800]="NOT_WINNING",Y[Y.PRE_OP=700]="PRE_OP",Y[Y.OP=400]="OP",Y[Y.G3=300]="G3",Y[Y.G2=200]="G2",Y[Y.G1=100]="G1";var Q,Z,ee=X;(Z=Q||(Q={}))[Z.TURF=1]="TURF",Z[Z.DART=2]="DART";var ne,te,re=Q;(te=ne||(ne={}))[te.JUNIOR=1]="JUNIOR",te[te.CLASSIC=2]="CLASSIC",te[te.SENIOR_OR_CLASSIC=3]="SENIOR_OR_CLASSIC",te[te.SENIOR=4]="SENIOR",te[te.URA=5]="URA";var ae=ne,ue=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"characters",void 0),u(this,"distance",void 0),u(this,"entryCount",void 0),u(this,"fanCounts",void 0),u(this,"grade",void 0),u(this,"ground",void 0),u(this,"half",void 0),u(this,"minFanCount",void 0),u(this,"month",void 0),u(this,"name",void 0),u(this,"permission",void 0),u(this,"stadium",void 0),u(this,"targetStatus",void 0),u(this,"track",void 0),u(this,"turn",void 0),this.characters=n.characters,this.distance=n.distance,this.entryCount=n.entryCount,this.fanCounts=n.fanCounts,this.grade=n.grade,this.ground=n.ground,this.half=n.half,this.minFanCount=n.minFanCount,this.month=n.month,this.name=n.name,this.permission=n.permission,this.stadium=n.stadium,this.targetStatus=n.targetStatus,this.track=n.track,this.turn=n.turn}var n,t,r;return n=e,(t=[{key:"years",value:function(){switch(this.permission){case ae.JUNIOR:return[1];case ae.CLASSIC:return[2];case ae.SENIOR_OR_CLASSIC:return[2,3];case ae.SENIOR:return[3];case ae.URA:return[4];default:throw Error("Race.years: unknown permission: ".concat(this.permission))}}},{key:"turnCounts",value:function(){var e=this;return this.years().map((function(n){return 24*(n-1)+2*(e.month-1)+e.half-1}))}},{key:"groundText",value:function(){return re[this.ground]}},{key:"isTargetRace",value:function(){return this.grade>=ee.DEBUT||this.permission>=ae.URA||void 0}}])&&a(n.prototype,t),r&&a(n,r),e}(),le=t({name:"SingleModeTurnWidget",props:{value:{type:Number,required:!0}},setup:function(e){return{turn:y((function(){return $(e.value)}))}}});var ie=E(le,[["render",function(e,n,t,r,a,u){return d(),f("div",null,[m("div",null,g(e.turn.yearText),1),m("div",null,g(e.turn.monthText),1),m("div",null,g(e.turn.halfText),1)])}]]),oe={class:"flex max-w-2xl m-1"},ce={class:"w-full rounded border-2 p-1 border-gray-200 flex flex-col justify-between max-w-lg"},se={class:"font-bold text-lg select-all"},de={class:"float-right text-sm sm:hidden text-gray-500"},fe=m("hr",{class:"border-t border-gray-300"},null,-1),me={class:"text-xs sm:text-sm text-gray-600 space-x-2"},pe={class:"flex w-full"},ve=t({props:{turn:{type:Number,required:!0},race:{type:ue,required:!0},action:{type:String,required:!0},hideDate:{type:Boolean}},emits:["update:action"],setup:function(e,n){var t=n.emit,r=V({emit:t},e,"action"),a=function(e){if(e.grade===ee.NOT_WINNING)return"...";switch(e.ground){case re.TURF:return"芝";case re.DART:return"ダート";default:return re[e.ground]}},u=function(e){return e.grade===ee.NOT_WINNING?"...":"".concat(e.distance,"m")},l=function(e){switch(e.grade){case ee.NOT_WINNING:return"未勝利戦";case ee.PRE_OP:return"Pre-OP";default:return ee[e.grade]}};return function(n,t){return d(),f("li",oe,[m("div",{class:p(["text-sm text-center w-24 flex-none hidden sm:flex my-2 flex-center",{invisible:e.hideDate}])},[b(ie,{value:e.turn},null,8,["value"])],2),m("div",ce,[m("div",null,[m("span",se,g(e.race.name),1),m("span",de,[b(z,{value:e.turn},null,8,["value"])])]),fe,m("div",me,[m("span",null,g((i=e.race,i.grade===ee.NOT_WINNING?"...":i.stadium)),1),m("span",null,g(l(e.race)),1),m("span",null,g(a(e.race)),1),m("span",null,g(u(e.race)),1),m("span",null," +"+g(e.race.fanCounts[0])+"人 ",1)]),m("div",pe,[b(K,{modelValue:_(r),"onUpdate:modelValue":t[0]||(t[0]=function(e){return N(r)?r.value=e:null})},null,8,["modelValue"])])])]);var i}}});function he(e){return null!=e}var xe=T(0);D.workboxCacheUpdate.addEventListener((function(e){e.data.payload.updatedURL===L&&(xe.value+=1)}));var ye=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.keepLatest,a=void 0!==r&&r,u=T(null==n?void 0:n.value);return O(e,(function(t){a||(u.value=T(null==n?void 0:n.value).value),t.then((function(n){e.value===t&&(u.value=T(n).value)}))}),{immediate:!0}),u}(y(r(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xe.value,e.next=3,fetch(L,{cache:"no-cache"});case 3:return n=e.sent,e.next=6,n.text();case 6:return e.t0=function(e){try{return new ue(JSON.parse(e))}catch(n){return}},e.t1=he,e.abrupt("return",e.sent.split("\n").map(e.t0).filter(e.t1));case 9:case"end":return e.stop()}}),e)})))),T([]),{keepLatest:!0});function ge(){return ye}var be={class:"flex flex-col overflow-hidden"},_e={class:"flex-none flex flex-wrap items-center space-x-2"},Ne={class:"inline-flex flex-col"},Te=w(" ダート "),Oe=w(" 芝 "),Ce={class:"inline-flex flex-wrap w-48 space-x-2"},Ae=w(" G1 "),Ie=w(" G2 "),Ue=w(" G3 "),we=w(" Pre-OP "),Pe=w(" OP "),Se=w(" 未勝利戦 "),Re=t({props:{modelValue:{type:Array,required:!0},defaultAction:{type:String,default:"none"}},emits:["update:modelValue"],setup:function(n,t){var r=t.emit,a=n,u=V({emit:r},a,"modelValue"),l=ge(),i=C({query:"",modifiedOnly:!1,includeTurf:!0,includeDart:!0,includeG1:!0,includeG2:!0,includeG3:!0,includePreOP:!0,includeOP:!0,includeNotWinning:!0}),o=y((function(){return l.value.flatMap((function(e){return e.turnCounts().map((function(n){return{turn:n,race:e}}))})).sort((function(e,n){return e.turn<n.turn?-1:1}))})),c=y((function(){return o.value.filter((function(e){if(e.race.isTargetRace())return!1;if(i.query.trim()&&!i.query.split(" ").filter((function(e){return e.trim()})).some((function(n){return e.race.name.includes(n)||e.race.stadium.includes(n)})))return!1;if(i.modifiedOnly&&!u.value.some((function(n){return n.turn===e.turn&&n.name===e.race.name})))return!1;if(e.race.grade!==ee.NOT_WINNING){if(!i.includeTurf&&e.race.ground===re.TURF)return!1;if(!i.includeDart&&e.race.ground===re.DART)return!1}return!(!i.includeG1&&e.race.grade===ee.G1)&&(!(!i.includeG2&&e.race.grade===ee.G2)&&(!(!i.includeG3&&e.race.grade===ee.G3)&&(!(!i.includePreOP&&e.race.grade===ee.PRE_OP)&&(!(!i.includeOP&&e.race.grade===ee.OP)&&!(!i.includeNotWinning&&e.race.grade===ee.NOT_WINNING)))))}))})),s=y((function(){return j(c.value,(function(e){return"".concat(e.turn,":").concat(e.race.name)})).map((function(n){var t,r;return{race:n.race,turn:n.turn,action:null!==(t=null===(r=u.value.find((function(e){return e.turn===n.turn&&e.name===n.race.name})))||void 0===r?void 0:r.action)&&void 0!==t?t:a.defaultAction,handleUpdateAction:function(t){u.value=[].concat(e(u.value.filter((function(e){return!(e.turn===n.turn&&e.name===n.race.name)}))),e(t===a.defaultAction?[]:[{turn:n.turn,name:n.race.name,action:t}]))}}}))}));return function(e,t){var r=A("VirtualList");return d(),f("div",be,[m("div",_e,[v(m("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return _(i).query=e}),type:"search",class:"form-input",placeholder:"Search race or stadium name"},null,512),[[I,_(i).query]]),m("div",Ne,[m("label",null,[Te,v(m("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return _(i).includeDart=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeDart]])]),m("label",null,[Oe,v(m("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return _(i).includeTurf=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeTurf]])])]),m("div",Ce,[m("label",null,[Ae,v(m("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return _(i).includeG1=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeG1]])]),m("label",null,[Ie,v(m("input",{"onUpdate:modelValue":t[4]||(t[4]=function(e){return _(i).includeG2=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeG2]])]),m("label",null,[Ue,v(m("input",{"onUpdate:modelValue":t[5]||(t[5]=function(e){return _(i).includeG3=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeG3]])]),m("label",null,[we,v(m("input",{"onUpdate:modelValue":t[6]||(t[6]=function(e){return _(i).includePreOP=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includePreOP]])]),m("label",null,[Pe,v(m("input",{"onUpdate:modelValue":t[7]||(t[7]=function(e){return _(i).includeOP=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeOP]])]),m("label",null,[Se,v(m("input",{"onUpdate:modelValue":t[8]||(t[8]=function(e){return _(i).includeNotWinning=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).includeNotWinning]])])]),m("label",null,[w(" modified ("+g(n.modelValue.length)+") ",1),v(m("input",{"onUpdate:modelValue":t[9]||(t[9]=function(e){return _(i).modifiedOnly=e}),class:"form-checkbox border",type:"checkbox"},null,512),[[U,_(i).modifiedOnly]])])]),b(r,{is:"ol",class:"flex-auto",values:_(s),"item-height":96},{default:P((function(e){var n,t=e.value,r=e.attrs,a=e.index;return[b(ve,S(r,{turn:t.turn,race:t.race,"hide-date":t.turn===(null===(n=_(s)[a-1])||void 0===n?void 0:n.turn),action:t.action,"onUpdate:action":t.handleUpdateAction}),null,16,["turn","race","hide-date","action","onUpdate:action"])]})),_:1},8,["values"])])}}});var ke={class:"flex mt-1"},Ge={class:"flex-auto"},Ve={class:"max-w-xl"},Ee={class:"flex items-center my-1"},De={class:"flex-auto flex items-center"},Le={type:"submit",class:"form-button flex-none w-32 h-10 inline-flex flex-center"},je={class:"inline align-top fill-current h-8",viewBox:"0 0 24 24"},qe=["d"];n("default",t({setup:function(e){var n=C({name:"custom_race",raceActions:[],defaultAction:"none"}),t=function(){var e,t=(e=n,"# -*- coding=UTF-8 -*-\n# Code generated by auto-derby-plugin-generator ".concat("89d8649","\n# URL: ",window.location.href,"\n# Date: ").concat((new Date).toISOString(),"\n\nimport auto_derby\nfrom auto_derby import single_mode\n\n\nfrom typing import Text, Dict, Tuple\n\n_ACTION_NONE = 0\n_ACTION_BAN = 1\n_ACTION_LESS = 2\n_ACTION_MORE = 3\n_ACTION_PICK = 4\n\n_DEFAULT_ACTION = _ACTION_").concat(e.defaultAction.toUpperCase(),"\n\n_RULES: Dict[Tuple[int, Text], int] = {\n").concat(k(e.raceActions,(function(e){return e.turn}),(function(e){return e.name})).map((function(e){return"    (".concat(e.turn,', "').concat(e.name,'"): _ACTION_').concat(e.action.toUpperCase(),",")})).join("\n"),"\n}\n\n\nclass Plugin(auto_derby.Plugin):\n    def install(self) -> None:\n        class Race(auto_derby.config.single_mode_race_class):\n            def score(self, ctx: single_mode.Context) -> float:\n                ret = super().score(ctx)\n                action = _RULES.get(\n                    (ctx.turn_count(), self.name),\n                    _DEFAULT_ACTION,\n                )\n                if action == _ACTION_BAN:\n                    ret = 0\n                elif action == _ACTION_LESS:\n                    ret -= 5\n                elif action == _ACTION_MORE:\n                    ret += 5\n                elif action == _ACTION_PICK:\n                    ret += 100\n                return ret\n\n        auto_derby.config.single_mode_race_class = Race\n\n\nauto_derby.plugin.register(__name__, Plugin())\n"));G.exports.saveAs(new Blob([t],{type:"application/octet-stream"}),"".concat(n.name,".py"))};return function(e,r){var a=A("i18n-t");return d(),f("form",{class:"flex-auto overflow-hidden flex flex-col max-w-xl",action:"javascript:void(0)",onSubmit:r[3]||(r[3]=function(e){return t()})},[b(Re,{modelValue:_(n).raceActions,"onUpdate:modelValue":r[0]||(r[0]=function(e){return _(n).raceActions=e}),class:"flex-auto","default-action":_(n).defaultAction},null,8,["modelValue","default-action"]),m("div",ke,[m("span",Ge,[b(a,{keypath:"race-plugin.default-strategy"})]),m("div",Ve,[b(K,{modelValue:_(n).defaultAction,"onUpdate:modelValue":r[1]||(r[1]=function(e){return _(n).defaultAction=e})},null,8,["modelValue"])])]),m("div",Ee,[m("label",De,[b(a,{keypath:"plugin.name"}),v(m("input",{"onUpdate:modelValue":r[2]||(r[2]=function(e){return _(n).name=e}),type:"text",class:"form-input flex-auto"},null,512),[[I,_(n).name]])]),m("button",Le,[(d(),f("svg",je,[m("path",{d:_(R)},null,8,qe)])),m("span",null,[b(a,{keypath:"plugin.generate"})])])])],32)}}}))}}}))}();
